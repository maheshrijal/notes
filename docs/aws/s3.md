---
title: Amazon S3
date: 2023-03-16
---

# Amazon S3 (Simple Storage Service)

- S3 allows to store objects (files) in buckets (directories)
- Bucket names are gloablly unique (across all AWS accounts)
- Buckets are defined at region level
- Max bucket size is 5TB (5000 GB)
- If uploading more than 5GB use "multi-part upload"

## Amazon S3: Security

#### User Based

- **Iam Policies** - API calls allowed or denied for speciric users

#### Resource Based

- **Bucket Policies** - Bucket wide rules from the S3 console - allows cross account (most common)

- **Object Access Control Lists (ACL)** - finer grained (can be disabled)

- **Bucket Access Control Lists (ACL)** - less common (can be disabled)

### S3 Bucket Policies

- JSON based policies
- Effect: Allow/Deny
- Actions: Set of API to allow or deny
- Principal: The account or user to apply the policy to

```
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "AllowAccessToAccount1",
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::123456789012:root"
      },
      "Action": [
        "s3:GetObject",
        "s3:PutObject"
      ],
      "Resource": "arn:aws:s3:::my-bucket/*"
    }
  ]
}
```

## Amazon S3: Replication

There are 2 types of (asynchronous) replication with S3: CRR (Cross region replication) & SRR (Same Region Replication)

- To enable replication, versioning must be enabled in source & destination buckets.
- Buckets that are to be replicated can be in different aws accounts.
- Buckets must have appropriate IAM permissions to read & write to the destination bucket.
- Once replication is enabled, only new objets are replicated. (To replicated existing objects, S3 batch replication can be used.)

!!! warning

    There is no chaining of replication. If bucket 1 has replication to bucket 2 and bucket 2 has replication to bucket 3, then objects created in bucket 1 are not replicated to bucket 3.

There is a option to enable Delete marker replication. This will also replicate the delete markers across buckets. Only delete markers are replicated and not actual deletes.


## Amazon S3: Durability & Availability

- High durability (99.999999999% or 11 9's) . On average for 10 million objects stored, you can expect to loose 1 object once every 10,000 years. Durability is same for all storage classes.

- Availability S3 Standard: 99.99% availability = 53 minutes downtime per year


## Amazon S3: Storage Classes

### S3 Standard - General Purpose

- 99.99 % availability
- Used for frequently accessed data
- Low latency & high throughput
- Can sustain 2 concurrent facility failures

### S3 Infrequent Access

- Used for data that is less frequently accessed, but requires rapid access when needed
- Lower cost than S3 standard, but chargeable for data retrieval

#### Amazon S3 Standard-Infrequent Access (S3 Standard IA)

- 99.99% availability
- Use cases: Disaster recovery, backups

#### Amazon S3 One Zone-Infrequent Access (S3 One Zone IA)

- Single AZ; datais lost if AZ is destroyed
- 99.5 % availability
- Use Cases: Storing secondary backup copies of on-premise data, or data that can be recreated

### Amzon S3 Glacier

- Low cost object storage meant for archiving/backup
- Pricing: Pay for Storage + Object retrieval cost

There are 3 Classes of Storage within Glacier

#### Glacier Instant Retrieval

- Millisecond retrieval, great for data accessed once a quarter
- Minimum storage duration is 90 days

#### Glacier Flexible Retrieval

- Retrieval Options: Expedited (1-3 Mins), Standard (3-5 hours), Bulk (5 - 12 ours)
- Minimum storage duration is 90 days

#### Glacier Deep Archive

- Retrieval Options: Standard (12 hours), Bulk (48 hours)
- Lowest Cost
- Minimum Storage Duration of 180 days

### S3 Intelligent-Tiering

- Small monthly monitoring & auto-tiering fee
- Moves objects automatically between access tiers based on usage
- There are no charges for retrieval

Tiers:

- Frequent Access (automatic) : Default
- Infrequent Access (automatic): objects not accessed for 30 days
- Archive Instant Access (automatic) : Objects not accessed for 90 days
- Archive Access Tier (optional): Configurable from 90 days to 700+ days
- Deep Archive Access Tier (optional): Configurable from 180 days to 700+ days